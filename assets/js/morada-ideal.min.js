function miNormalizeText(e){let t=e.toLowerCase(),a={"á":"a","à":"a","ã":"a","â":"a","ä":"a","é":"e","è":"e","ê":"e","ë":"e","í":"i","ì":"i","î":"i","ï":"i","ó":"o","ò":"o","õ":"o","ô":"o","ö":"o","ú":"u","ù":"u","û":"u","ü":"u","ç":"c","ñ":"n"};return t=(t=t.replace(/[áàãâäéèêëíìîïóòõôöúùûüçñ]/g,e=>a[e])).replace(/\s+/g,"-")}function miInitAutocomplete(){document.querySelectorAll(".autocomplete-wrapper").forEach(t=>{var a=t.querySelector(".autocomplete");if(a){autocomplete=new google.maps.places.Autocomplete(a,{componentRestrictions:{country:["PT"]},fields:["place_id","geometry","name","address_components"]});let e=t.querySelector(".autocomplete-message");a.addEventListener("change",e=>{}),autocomplete.addListener("place_changed",()=>miOnPlaceChanged(e))}})}function miOnPlaceChanged(t){var a=autocomplete.getPlace(),o=(console.log("place",a),t.closest("form"));if(o){var r=o.querySelector('input[name="lat"]'),i=o.querySelector('input[name="lng"]'),l=o.querySelector('input[name="imovel_estado"]'),n=o.querySelector('input[name="imovel_cidade"]'),s=o.querySelector('input[name="imovel_codigo_postal"]'),o=o.querySelector('input[name="imovel_rua"]'),c=document.getElementById("new-imovel-form-btn");let e="";if(c&&c.setAttribute("disabled",""),t&&(t.style.display="block"),r)if(i)if(a.geometry){lat=a.geometry.location.lat(),lng=a.geometry.location.lng();var d=a.address_components.filter(e=>e.types.includes("administrative_area_level_1")),m=a.address_components.filter(e=>e.types.includes("administrative_area_level_2")),u=a.address_components.filter(e=>e.types.includes("postal_code")),p=a.address_components.filter(e=>e.types.includes("route")),a=(document.getElementById("autocomplete").innerHTML=a.name,r.value=lat,i.value=lng,l&&(l.value=d[0]?.short_name||""),n&&(n.value=m[0]?.short_name||""),s&&(s.value=u[0]?.short_name||""),o&&(o.value=p[0]?.long_name||""),document.getElementById("table-regiao-imoveis"));if(a){m=a.querySelector('[type="search"');if(m){m.value=d[0]?.short_name,m.dispatchEvent(new Event("keyup"));let a=miNormalizeText(d[0]?.short_name);(e=document.querySelectorAll('[name="regiao-terms[]"]')).forEach(e=>{var t=miNormalizeText(e.getAttribute("data-name"));a===t&&(e.checked=!0,e.dispatchEvent(new Event("change")))})}}t.style.display="none",c&&c.removeAttribute("disabled")}else{document.getElementById("autocomplete").placeholder="Digite um endereço",r.value="",i.value="",tateInput&&(l.value=""),n&&(n.value=""),s&&(s.value=""),o&&(o.value=""),t.style.display="block",c&&c.setAttribute("disabled","");u=document.getElementById("table-regiao-imoveis");u&&(p=u.querySelector('[type="search"'))&&((e=document.querySelectorAll('[name="regiao-terms[]"]')).forEach(e=>{e.checked=!1,e.dispatchEvent(new Event("change"))}),p.value="",p.dispatchEvent(new Event("keyup")))}else console.error("Não foi possível encontrar o input de longitude");else console.error("Não foi possível encontrar o input de latitude")}else console.error("Não foi possível encontrar o formulário do autocomplete")}function initGoogleApi(){window.addEventListener("load",function(){miInitAutocomplete()})}(()=>{let e=Object.values(ajax_object.imoveis);function o(){let i=document.getElementById("user_pass");if(i,i){let r=document.querySelectorAll(".meter-section");r.length<=0||i.addEventListener("keyup",()=>{{var a=i,o=r;let e=a.value,t=(e=>{let t=0;return t+=.2*e.length,/[A-Z]/.test(e)&&(t+=.5),/[a-z]/.test(e)&&(t+=.5),/\d/.test(e)&&(t+=.7),/[^A-Za-z0-9]/.test(e)&&(t+=1),t})(e);o.forEach(e=>{e.classList.remove("weak","medium","strong","very-strong")}),1<=t&&o[0].classList.add("weak"),2<=t&&o[1].classList.add("medium"),3<=t&&o[2].classList.add("strong"),4<=t&&o[3].classList.add("very-strong"),console.log("strength",t)}})}}function c(e,t,a){console.log(t);var o=document.createElement("div");o.innerHTML=[`<div id="contact-form-alert" class="alert alert-${a} alert-dismissible" role="alert">`,`   <div>${t}</div>`,'   <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>',"</div>"].join(""),e.append(o)}function r(){var e=document.querySelectorAll(".mi-caracteristicas-especificas-group");Array.from(e).forEach(e=>{var t=e.querySelector(".mi-caracteristicas-especificas-group-list"),a=e.querySelectorAll(".list-group-item"),o=e.querySelector(".mi-group-new-item-btn");!a||a.length<=0?console.error("Não foi encontrado nenhum item da lista de perguntas e respostas (FAQ)."):t?o?(a=o,(o=(t=e).querySelector(".mi-caracteristicas-especificas-group-list"))?a.addEventListener("click",function(e,t,a){a.preventDefault();var a=document.createElement("li"),o=(a.classList.add("mi-caracteristicas-especificas-group-item"),a.classList.add("list-group-item"),a.id="mi-caracteristicas-especificas-group-item-",a.dataset.faqGroupItemId="",document.createElement("label")),o=(o.setAttribute("for","imovel_caracteristicas-especificas-"),o.classList.add("form-label"),o.innerText="Característica",a.append(o),document.createElement("input")),o=(o.setAttribute("type","text"),o.classList.add("form-control"),o.id="imovel_caracteristicas-especificas-",o.name="imovel_caracteristicas-especificas[]",a.append(o),document.createElement("div")),o=(o.classList.add("invalid-feedback"),o.innerText="Campo obrigatório",a.append(o),document.createElement("div")),r=(o.classList.add("d-flex"),document.createElement("a"));r.classList.add("mi-delete-caracteristicas-especificas-group"),r.classList.add("btn"),r.classList.add("btn-danger"),r.classList.add("btn-sm"),r.classList.add("mt-2"),r.classList.add("ms-auto"),r.innerHTML='<i class="bi bi-x-circle-fill"></i> Remover item',o.append(r),a.append(o),e.append(a),l(t),i(t)}.bind(null,o,t)):console.error("Não foi encontrado a lista de itens de perguntas e respostas (FAQ)."),l(e)):console.error("Não foi encontrado o botão para adicionar novos itens na lista de perguntas e respostas (FAQ)."):console.error("Não foi encontrado a lista de itens de perguntas e respostas (FAQ).")})}function i(e){var t=e.querySelector(".mi-caracteristicas-especificas-group-list"),e=e.querySelectorAll(".list-group-item");if(!e||e.length<=0)console.error("Não foi encontrado nenhum item da lista de perguntas e respostas (FAQ).");else{if(t)return Array.from(e).forEach((e,t)=>{let a="imovel_caracteristicas-pergunta-"+(e.dataset.faqGroupItemId=t),o="imovel_caracteristicas-resposta-"+t;t=e.querySelectorAll("label"),e=e.querySelectorAll("input");t.forEach((e,t)=>{0===t?e.setAttribute("for",a):e.setAttribute("for",o)}),e.forEach((e,t)=>{0===t&&(e.id=a)})}),e.length;console.error("Não foi encontrado a lista de itens de perguntas e respostas (FAQ).")}}function l(t){var e=document.querySelectorAll(".mi-delete-caracteristicas-especificas-group");Array.from(e).forEach(e=>{e.removeEventListener("click",a),e.addEventListener("click",a.bind(null,t))})}function a(e,t){t.preventDefault();e=i(e),t=t.target.closest(".mi-caracteristicas-especificas-group-item");1<e?t.remove():t.querySelector("input").value=""}console.log(e),document.addEventListener("DOMContentLoaded",function(){t=document.querySelectorAll(".needs-validation"),Array.from(t).forEach(t=>{t.addEventListener("submit",e=>{t.checkValidity()||(e.preventDefault(),e.stopPropagation()),t.classList.add("was-validated")},!1)}),o(),t=document.querySelectorAll(".toast"),Array.from(t).forEach(e=>{console.log("toasts"),bootstrap.Toast.getOrCreateInstance(e).show()}),(t=document.getElementById("user_phone"))&&IMask(t,{mask:"(00) 0000-0000[0]"}),(t=document.getElementById("user_whatsapp"))&&IMask(t,{mask:"(00) 0000-00000"});var e,t=document.getElementById("imovel_price"),a={mask:"num",blocks:{num:{mask:Number,scale:2,thousandsSeparator:".",padFractionalZeros:!0,radix:",",mapToRadix:["."]}}};t&&IMask(t,a),t=document.querySelectorAll(".go-back-btn"),Array.from(t).forEach(e=>{e.addEventListener("click",e=>{e.preventDefault(),history.back()})}),a=document.querySelectorAll('input[type="file"]'),Array.from(a).forEach(e=>{e.onchange=function(){2097152<this.files[0].size&&(alert("O arquivo é muito pesado, o tamanho máximo permitido é de 2MB."),this.value="")}}),[...document.querySelectorAll('[data-bs-toggle="tooltip"]')].map(e=>new bootstrap.Tooltip(e)),document.querySelectorAll(".mi-file-image-preview").forEach(e=>{let o=e.querySelector('input[type="file"]'),r=e.querySelector(".images-preview"),i=e.querySelector(".btn-clear-image"),l=e.querySelector('input[name="changed-thumbnail"]');i.addEventListener("click",e=>{for(e.preventDefault(),o.value=null;r.firstChild;)r.removeChild(r.lastChild);i.style.display="none",l.value="true"}),o.addEventListener("change",e=>{for(var t,e=e.target.files;r.firstChild;)r.removeChild(r.lastChild);for(t of e){var a=document.createElement("img");a.classList.add("image-preview"),a.src=URL.createObjectURL(t),r.append(a)}i.style.display="block",l.value="true",console.log("fileInput",o.value)})}),document.querySelectorAll(".clear-input-value").forEach(t=>{t.addEventListener("click",e=>{e.preventDefault();e=document.getElementById(t.dataset.input);e&&(e.value="")})}),document.querySelectorAll(".mi-contact-form").forEach(s=>{s.addEventListener("submit",l=>{if(l.preventDefault(),document.getElementById("contact-form-alert"),document.getElementById("contact-form-alert")&&bootstrap.Alert.getOrCreateInstance("#contact-form-alert").close(),s.checkValidity()){s.classList.add("was-validated");let a=s.querySelector("#nome"),o=s.querySelector("#email"),r=s.querySelector("#mensagem"),i=s.querySelector("button");if(i,i&&!i.disabled){i.disabled=!0;let e=i.innerText;i.innerText="Enviando...";var l=ajax_object.ajax_url,n=new FormData(s);n.get("action");let t=document.getElementById("contact-form-alert-placeholder");fetch(l,{method:"POST",body:n}).then(e=>e.json()).then(e=>{c(t,e.data.msg,"success"),a.value="",o.value="",r.value=""}).catch(e=>{console.error(e),c(t,e,"danger")}).finally(()=>{i.disabled=!1,i.innerText=e,s.classList.remove("was-validated")})}}})}),a={...t={page:10,pagination:[{item:'<li class="page-item"><a class="page page-link"></a></li>'}]},valueNames:["nome","data"]},t={...t,valueNames:["nome"],page:10},e=document.getElementById("table-operacao-imoveis"),new List(e,t),e=document.getElementById("table-tipo-imoveis"),new List(e,t),e=document.getElementById("table-regiao-imoveis"),new List(e,t),e=document.getElementById("table-caracteristicas-gerais-imoveis"),new List(e,t),e=document.getElementById("table-tipologia-imoveis"),new List(e,t),e=document.getElementById("table-outras-denominacoes-imoveis"),new List(e,t),e=document.getElementById("table-casas-de-banho-imoveis"),new List(e,t),e=document.getElementById("table-estado-imoveis"),new List(e,t),e=document.getElementById("table-filtro-imoveis"),new List(e,t),e=document.getElementById("table-andar-imoveis"),new List(e,t),e=document.getElementById("my-imoveis"),new List(e,a),r()})})(),initGoogleApi();